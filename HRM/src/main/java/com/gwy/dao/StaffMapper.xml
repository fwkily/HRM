<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gwy.dao.StaffMapper" >
    <insert id="addStaff" keyProperty="S_ID" useGeneratedKeys="true" parameterType="com.gwy.model.Staff">
        INSERT INTO HRM_STAFF(S_ID, S_USERNAME, S_PASS, D_ID, J_ID, S_STATE, S_NAME, S_SEX, S_IDCARDNO, S_BIRTHDAY, S_PHONE, S_EMAIL, S_ADDRESS, S_POST, S_EDUCATION, S_COLLEGE, S_MAJOR, S_GRADUATE, S_INTRO, S_ENTRYDATE)
        VALUES (STAFF_SEQ.nextval,null,null,#{department.d_id},#{job.j_id},
        #{s_state},#{s_name},#{s_sex},#{s_idcardno},#{s_birthday},#{s_phone},#{s_email},
        #{s_address},#{s_post},#{s_education},#{s_college},#{s_major},#{s_graduate},#{s_intro},sysdate)
    </insert>
    <select id="getStaffByDidJidState" resultType="java.lang.Integer">
        SELECT count(*) FROM HRM_STAFF
        <where>
            <if test="d_id!=0">
                D_ID=#{d_id}
            </if>
            <if test="j_id!=0">
                and J_ID=#{j_id}
            </if>
            <if test="s_state>=0">
                and S_STATE=#{s_state}
            </if>
        </where>
    </select>
    <select id="queryCurrentPageStaffByDidJidState" resultMap="staffMap1">
        SELECT * FROM (SELECT HRM_STAFF.*,rownum rn FROM HRM_STAFF
        <where>
            <if test="param1!=0">
                D_ID=#{param1}
            </if>
            <if test="param2!=0">
                and J_ID=#{param2}
            </if>
            <if test="param3>=0">
                and S_STATE=#{param3}
            </if>
        </where>) S,HRM_DEPARTMENT,HRM_JOB
        where S.D_ID=HRM_DEPARTMENT.D_ID
        and S.J_ID=HRM_JOB.J_ID
        and rn between #{param4} and #{param5}
    </select>
    <select id="getStaffsByDidJidState" resultMap="staffMap1">
        SELECT * FROM HRM_STAFF
        <where>
            <if test="d_id!=0">
                D_ID=#{d_id}
            </if>
            <if test="j_id!=0">
                and J_ID=#{j_id}
            </if>
            <if test="s_state>=0">
                and S_STATE=#{s_state}
            </if>
        </where>
    </select>


    <resultMap id="staffMap" type="com.gwy.model.Staff">
        <id property="s_id" column="S_ID"/>
        <result property="s_username" column="S_USERNAME"/>
        <result property="s_pass" column="S_PASS"/>
        <result property="s_state" column="S_STATE"/>
        <result property="s_name" column="S_NAME"/>
        <result property="s_sex" column="S_SEX"/>
        <result property="s_idcardno" column="S_IDCARDNO"/>
        <result property="s_birthday" column="S_BIRTHDAY"/>
        <result property="s_phone" column="S_PHONE"/>
        <result property="s_email" column="S_EMAIL"/>
        <result property="s_address" column="S_ADDRESS"/>
        <result property="s_post" column="S_POST"/>
        <result property="s_education" column="S_EDUCATION"/>
        <result property="s_college" column="S_COLLEGE"/>
        <result property="s_major" column="S_MAJOR"/>
        <result property="s_graduate" column="S_GRADUATE"/>
        <result property="s_intro" column="S_INTRO"/>
        <result property="s_entrydate" column="S_ENTRYDATE"/>
    </resultMap>
    <resultMap id="staffMap1" type="com.gwy.model.Staff" extends="staffMap">
        <association property="department" resultMap="com.gwy.dao.DepartmentMapper.departmentMap"/>
        <association property="job" resultMap="com.gwy.dao.JobMapper.jobMap"/>
    </resultMap>
</mapper>
